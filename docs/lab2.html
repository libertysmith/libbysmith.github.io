<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>lab2 – Portfolio of Libby Smith</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Portfolio of Libby Smith</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./writing.html"> 
<span class="menu-text">Analysis Writing</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-methods-of-data-collection" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Methods of Data Collection</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-methods-of-data-collection">    
        <li>
    <a class="dropdown-item" href="./assignment1.html">
 <span class="dropdown-text">Create a Qualtrics Survey</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment2.html">
 <span class="dropdown-text">Google Trends VS Rstudio gtrends</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment3.html">
 <span class="dropdown-text">Latent Semantic Text Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment5.html">
 <span class="dropdown-text">Web Scraping for Word Clouds</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment6.html">
 <span class="dropdown-text">Scraping Government Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment7.html">
 <span class="dropdown-text">API Requests of Public Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-independent-research" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Independent Research</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-independent-research">    
        <li>
    <a class="dropdown-item" href="./datacollectionproject.html">
 <span class="dropdown-text">AAPI in the News - NLP Machine Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./datavisualisationprjct.html">
 <span class="dropdown-text">Precinct Voting to County-Wide - Turnout Effects</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-graphics-and-visualizations" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Graphics and Visualizations</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-graphics-and-visualizations">    
        <li>
    <a class="dropdown-item" href="./lab1.html">
 <span class="dropdown-text">The Statistical Importance of Graphics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab1b.html">
 <span class="dropdown-text">Critiquing Graphics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab2.html">
 <span class="dropdown-text">Selecting Graphical Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab3.html">
 <span class="dropdown-text">Plot Design in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab3b.html">
 <span class="dropdown-text">When Big Data Goes Bad. A Critique</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab3c.html">
 <span class="dropdown-text">Comparing Graphics Approaches</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab4.html">
 <span class="dropdown-text">4 Chart Types</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab5.html">
 <span class="dropdown-text">Literate Programming</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab6.html">
 <span class="dropdown-text">Demonstrating Shiny</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab7.html">
 <span class="dropdown-text">Two Shiny Graphics</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#choosing-the-best-graphic" id="toc-choosing-the-best-graphic" class="nav-link active" data-scroll-target="#choosing-the-best-graphic">Choosing the Best Graphic</a>
  <ul class="collapse">
  <li><a href="#graphing-hpi-across-nations" id="toc-graphing-hpi-across-nations" class="nav-link" data-scroll-target="#graphing-hpi-across-nations">Graphing HPI Across Nations</a>
  <ul class="collapse">
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data Cleaning</a></li>
  </ul></li>
  <li><a href="#high-level-plot" id="toc-high-level-plot" class="nav-link" data-scroll-target="#high-level-plot">High-Level Plot</a>
  <ul class="collapse">
  <li><a href="#graphing-life-expectancy-vs-gdp-per-capita" id="toc-graphing-life-expectancy-vs-gdp-per-capita" class="nav-link" data-scroll-target="#graphing-life-expectancy-vs-gdp-per-capita">Graphing Life Expectancy vs GDP per Capita</a></li>
  </ul></li>
  <li><a href="#histogram-displaying-carbon-footprints" id="toc-histogram-displaying-carbon-footprints" class="nav-link" data-scroll-target="#histogram-displaying-carbon-footprints">Histogram: Displaying Carbon Footprints</a></li>
  <li><a href="#barplots-of-continental-gdp-and-well-being" id="toc-barplots-of-continental-gdp-and-well-being" class="nav-link" data-scroll-target="#barplots-of-continental-gdp-and-well-being">Barplots of Continental GDP and Well-Being</a></li>
  <li><a href="#boxplot" id="toc-boxplot" class="nav-link" data-scroll-target="#boxplot">Boxplot</a></li>
  <li><a href="#pie-charts-of-well-being-across-continents" id="toc-pie-charts-of-well-being-across-continents" class="nav-link" data-scroll-target="#pie-charts-of-well-being-across-continents">Pie Charts of Well-Being Across Continents</a></li>
  </ul></li>
  <li><a href="#the-end" id="toc-the-end" class="nav-link" data-scroll-target="#the-end">The End</a></li>
  </ul>
</nav>
    <div class="quarto-margin-footer"><div class="margin-footer-item">
<p><img src=".\utdfooter.jpg" class="img-fluid"></p>
</div></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">




<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">warning =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="choosing-the-best-graphic" class="level1">
<h1>Choosing the Best Graphic</h1>
<section id="graphing-hpi-across-nations" class="level2">
<h2 class="anchored" data-anchor-id="graphing-hpi-across-nations">Graphing HPI Across Nations</h2>
<p><img src="images/Screenshot 2024-09-24 194541.jpg" class="img-fluid"></p>
<p>The Happy Planet Index (HPI) is an innovative measure that combines three key indicators to assess how effectively countries use environmental resources to support long, happy lives for their citizens:</p>
<p><strong>Wellbeing:</strong> This metric reflects how satisfied residents of each country are with their lives, measured on a scale from zero to ten. The data is sourced from the Gallup World Poll.</p>
<p><strong>Life Expectancy:</strong> This measures the average number of years a person can expect to live in each country, based on statistics provided by the United Nations Development Programme (UNDP).</p>
<p><strong>Carbon Footprint:</strong> This metric estimates the per capita greenhouse gas emissions associated with a country’s consumption and economic activities.</p>
<p>The data is drawn from the World Inequality Database and the Global Carbon Atlas, supplemented by the EORA Global Supply Chain Database. It accounts for both direct emissions (e.g., energy consumption within the country) and emissions generated during the production of goods and services consumed within the country, irrespective of where they are produced. This includes emissions from individual consumption, government activities, and business investments.</p>
<section id="data-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h3>
<p>The dataset used is represents the year 2021 and is sourced from the <a href="https://happyplanetindex.org/">Happy Planet Index</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>happyplanetdf <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"C:/Users/hirel/OneDrive/Documents/SDAR - FW23/Methods of Data Collection/quartogit/HPI_2024_public_dataset.xlsx"</span>, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sheet =</span> <span class="st">"1. All countries"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...1`
• `` -&gt; `...3`
• `` -&gt; `...4`
• `` -&gt; `...5`
• `` -&gt; `...6`
• `` -&gt; `...7`
• `` -&gt; `...8`
• `` -&gt; `...9`
• `` -&gt; `...10`
• `` -&gt; `...11`
• `` -&gt; `...12`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>happyplanetdf <span class="ot">&lt;-</span> happyplanetdf[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), ] <span class="co"># Redundant rows</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>happyplanetdf <span class="ot">&lt;-</span> happyplanetdf[ , <span class="sc">-</span><span class="dv">4</span>] <span class="co"># Redundant Column</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(happyplanetdf) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">unlist</span>(happyplanetdf[<span class="dv">1</span>,]))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>happyplanetdf <span class="ot">&lt;-</span> happyplanetdf[<span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(happyplanetdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "HPI rank"                          "Country"                          
 [3] "ISO"                               "Continent"                        
 [5] "Population (thousands)"            "Life Expectancy (years)"          
 [7] "Ladder of life (Wellbeing) (0-10)" "Carbon Footprint (tCO2e)"         
 [9] "HPI"                               "CO2 threshold for year  (tCO2e)"  
[11] "GDP per capita ($)"               </code></pre>
</div>
</div>
<p>Above, we read in the data and remove redundant rows in preparation of testing various graphical representations. colnames shows you how all columns are labelled.</p>
<p>Next, we transform the column data to be easily analyzed in Rstudio according to its data type.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert columns in happyplanetdf</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>happyplanetdf <span class="ot">&lt;-</span> happyplanetdf <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Country =</span> <span class="fu">as.factor</span>(Country),  <span class="co"># Nominal categorical</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ISO =</span> <span class="fu">as.factor</span>(ISO),  <span class="co"># Nominal categorical</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">HPI rank</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">HPI rank</span><span class="st">`</span>, <span class="at">ordered =</span> <span class="cn">TRUE</span>),  <span class="co"># Ordinal categorical</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Continent =</span> <span class="fu">as.factor</span>(Continent),  <span class="co"># Nominal categorical</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Population (thousands)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Population (thousands)</span><span class="st">`</span>),  <span class="co"># Continuous numerical</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span>),  <span class="co"># Continuous numerical</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Ladder of life (Wellbeing) (0-10)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Ladder of life (Wellbeing) (0-10)</span><span class="st">`</span>),  <span class="co"># Continuous numerical</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">HPI =</span> <span class="fu">as.numeric</span>(HPI),  <span class="co"># Continuous numerical</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">CO2 threshold for year  (tCO2e)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">CO2 threshold for year  (tCO2e)</span><span class="st">`</span>),  <span class="co"># Continuous numerical</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Carbon Footprint (tCO2e)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Carbon Footprint (tCO2e)</span><span class="st">`</span>),  <span class="co"># Continuous numerical</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">GDP per capita ($)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">GDP per capita ($)</span><span class="st">`</span>)  <span class="co"># Continuous numerical</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Some data in the original file was not read in from the xl file. Thus, I recreated them to categorize each country’s Life Expectancy, Wellbeing, and Carbon Footprint into three labels: Poor, Average, and Good. This will be useful for our graphics later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Categorize Life Expectancy, Wellbeing, and Carbon Footprint</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>happyplanetdf <span class="ot">&lt;-</span> happyplanetdf <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Categorize Life Expectancy</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Life_Expectancy_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="fl">65.0</span> <span class="sc">~</span> <span class="st">"Poor"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="fl">65.0</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="fl">75.0</span> <span class="sc">~</span> <span class="st">"Average"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="fl">75.0</span> <span class="sc">~</span> <span class="st">"Good"</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>  <span class="co"># For missing values, set NA</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Categorize Wellbeing</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Wellbeing_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Ladder of life (Wellbeing) (0-10)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="fl">5.0</span> <span class="sc">~</span> <span class="st">"Poor"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Ladder of life (Wellbeing) (0-10)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="fl">5.1</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Ladder of life (Wellbeing) (0-10)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="fl">6.0</span> <span class="sc">~</span> <span class="st">"Average"</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Ladder of life (Wellbeing) (0-10)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="fl">6.0</span> <span class="sc">~</span> <span class="st">"Good"</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>  <span class="co"># For missing values, set NA</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Categorize Carbon Footprint</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Carbon_Footprint_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Carbon Footprint (tCO2e)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="fl">6.36</span> <span class="sc">~</span> <span class="st">"Poor"</span>,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Carbon Footprint (tCO2e)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="fl">6.35</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Carbon Footprint (tCO2e)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="fl">3.19</span> <span class="sc">~</span> <span class="st">"Average"</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Carbon Footprint (tCO2e)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="fl">3.18</span> <span class="sc">~</span> <span class="st">"Good"</span>,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>  <span class="co"># For missing values, set NA</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co"># View the updated dataset with new categorical columns</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(happyplanetdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 14
  `HPI rank` Country     ISO   Continent `Population (thousands)`
  &lt;ord&gt;      &lt;fct&gt;       &lt;fct&gt; &lt;fct&gt;                        &lt;dbl&gt;
1 &lt;NA&gt;       Burundi     BDI   5                           12551.
2 &lt;NA&gt;       Sudan       SDN   5                           45657.
3 1          Vanuatu     VUT   8                             319.
4 2          Sweden      SWE   3                           10467.
5 3          El Salvador SLV   1                            6314.
6 4          Costa Rica  CRI   1                            5154.
# ℹ 9 more variables: `Life Expectancy (years)` &lt;dbl&gt;,
#   `Ladder of life (Wellbeing) (0-10)` &lt;dbl&gt;,
#   `Carbon Footprint (tCO2e)` &lt;dbl&gt;, HPI &lt;dbl&gt;,
#   `CO2 threshold for year  (tCO2e)` &lt;dbl&gt;, `GDP per capita ($)` &lt;dbl&gt;,
#   Life_Expectancy_Category &lt;chr&gt;, Wellbeing_Category &lt;chr&gt;,
#   Carbon_Footprint_Category &lt;chr&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="high-level-plot" class="level2">
<h2 class="anchored" data-anchor-id="high-level-plot">High-Level Plot</h2>
<section id="graphing-life-expectancy-vs-gdp-per-capita" class="level3">
<h3 class="anchored" data-anchor-id="graphing-life-expectancy-vs-gdp-per-capita">Graphing Life Expectancy vs GDP per Capita</h3>
<p>One important insight with consensus among social scientists is the relationship between wealth and life expectancy. Below I test this relationship with the variables of Life Expectancy and GDP per capita from HPI’s dataset to exhibit the utility of plots. Plots are useful to display a relationship between two or more variables. I decided to label a handful of observations from different global regions that represent different cultures and governing styles to provoke thinking in the reader.</p>
<p>None of the text font of the graphic is the default. In choosing Times New Roman font, it will serve a more universal audience of English readers. I chose the colors of the points in a specific manner to intuitively teach the readers about where the average life expectancy of each country falls on a scale of poor to average to good. I chose not to use the exact shades of red, yellow, and green and instead chose lighter shades of the same. The background of the graphic is a light shade of grey. All colors chosen enhances the readability and is more inviting to the eye than the more extreme pigments the graphic would otherwise default to. No matter the lighting available to a reader using a screen, the colors will not add to eye strain.</p>
<p>I chose to add padding to the margins to help the reader’s eye to center the data and to promote more focus in the reader. I customized the starting point scale of the x-axis in order to center the data points in the graph and remove excess space that served no purpose. I customized the y-axis tick marks from technical terms to layman’s terms to make it easier to interpret for a wider range of people. Doing so changed the GDP units of measurements like 0e+00 to 0K (in US dollars).</p>
<p>I fit a linear regression model to superimpose a trend line on the graph. This emphasizes the positive linear relationship so that the reader does not have to deduce this by interpreting the shape of the points. Normally, I would refrain from placing the legend inside the graph however, there was ample redundant space in the top-left side to accommodate it without cluttering the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">windowsFonts</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$serif
[1] "TT Times New Roman"

$sans
[1] "TT Arial"

$mono
[1] "TT Courier New"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Registering and using a font:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">windowsFonts</span>(<span class="at">Times =</span> <span class="fu">windowsFont</span>(<span class="st">"Times New Roman"</span>))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the background color of the entire plot area to gray</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"gray87"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family =</span> <span class="st">"Times"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Life Expectancy Category column if not already created</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>happyplanetdf <span class="ot">&lt;-</span> happyplanetdf <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Life_Expectancy_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="fl">65.0</span> <span class="sc">~</span> <span class="st">"Poor"</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="fl">65.0</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="fl">75.0</span> <span class="sc">~</span> <span class="st">"Average"</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="fl">75.0</span> <span class="sc">~</span> <span class="st">"Good"</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the color map for the Life Expectancy categories</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>color_map <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Poor"</span> <span class="ot">=</span> <span class="st">"indianred3"</span>, <span class="st">"Average"</span> <span class="ot">=</span> <span class="st">"yellow2"</span>, <span class="st">"Good"</span> <span class="ot">=</span> <span class="st">"limegreen"</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Map the colors to the Life Expectancy categories</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>point_colors <span class="ot">&lt;-</span> color_map[happyplanetdf<span class="sc">$</span>Life_Expectancy_Category]</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the relevant columns and remove rows with NA values in x or y</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> happyplanetdf <span class="sc">%&gt;%</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span>), <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">GDP per capita ($)</span><span class="st">`</span>))</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign cleaned columns to variables</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> cleaned_data<span class="sc">$</span><span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span>  <span class="co"># Life Expectancy (years) as x-axis</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> cleaned_data<span class="sc">$</span><span class="st">`</span><span class="at">GDP per capita ($)</span><span class="st">`</span>       <span class="co"># GDP per capita ($) as y-axis</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate appropriate x-axis limits based on data</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>x_min <span class="ot">&lt;-</span> <span class="fu">min</span>(x) <span class="sc">-</span> <span class="dv">2</span>  <span class="co"># Add padding to the minimum value</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>x_max <span class="ot">&lt;-</span> <span class="fu">max</span>(x) <span class="sc">+</span> <span class="dv">2</span>  <span class="co"># Add padding to the maximum value</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Set label orientation, margins, and text size</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">las=</span><span class="dv">1</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>), <span class="at">cex=</span>.<span class="dv">9</span>)</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a customized scatter plot with custom x and y axis ticks</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, </span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Life Expectancy (years)"</span>, </span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"GDP per Capita ($)"</span>, </span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Life Expectancy vs GDP per Capita"</span>,</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> point_colors, <span class="at">cex=</span><span class="fl">1.5</span>, </span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(x_min, x_max), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100000</span>),  <span class="co"># Custom limits for x and y axes</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt=</span><span class="st">'n'</span>, <span class="at">yaxt=</span><span class="st">'n'</span>)  <span class="co"># Suppress default axes</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Add custom x and y axes with specific tick marks</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">floor</span>(x_min), <span class="fu">ceiling</span>(x_max), <span class="at">by=</span><span class="dv">5</span>), <span class="at">col.axis=</span><span class="st">"gray50"</span>, <span class="at">cex.axis=</span><span class="fl">0.8</span>)</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Create custom labels for the y-axis using "K" for thousands</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>y_ticks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100000</span>, <span class="at">by=</span><span class="dv">20000</span>)</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>y_labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(y_ticks <span class="sc">/</span> <span class="dv">1000</span>, <span class="st">"K"</span>)  <span class="co"># Convert to 'K' format (e.g., 20K, 40K)</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the custom y-axis with the new labels</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span>y_ticks, <span class="at">labels=</span>y_labels, <span class="at">col.axis=</span><span class="st">"gray50"</span>, <span class="at">cex.axis=</span><span class="fl">0.8</span>)</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a trend line using linear regression</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)  <span class="co"># Fit a linear model</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fit, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>)  <span class="co"># Add the regression line</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Add custom grid lines for better visualization</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>y_ticks, <span class="at">col=</span><span class="st">"lightgray"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">seq</span>(<span class="fu">floor</span>(x_min), <span class="fu">ceiling</span>(x_max), <span class="at">by=</span><span class="dv">5</span>), <span class="at">col=</span><span class="st">"lightgray"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a><span class="co"># List of countries to highlight</span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>highlight_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"United States of America"</span>, <span class="st">"Denmark"</span>, <span class="st">"Japan"</span>, <span class="st">"Panama"</span>, <span class="st">"South Africa"</span>, <span class="st">"India"</span>)</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract rows for those countries</span></span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>highlight_data <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">%in%</span> highlight_countries)</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Add circles around the selected countries and annotate them</span></span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a><span class="fu">symbols</span>(highlight_data<span class="sc">$</span><span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span>, highlight_data<span class="sc">$</span><span class="st">`</span><span class="at">GDP per capita ($)</span><span class="st">`</span>, </span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">circles=</span><span class="fu">rep</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(highlight_data)), <span class="at">inches=</span><span class="fl">0.1</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">fg=</span><span class="st">"blue"</span>)</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Add text annotations for the highlighted countries</span></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(highlight_data<span class="sc">$</span><span class="st">`</span><span class="at">Life Expectancy (years)</span><span class="st">`</span>, highlight_data<span class="sc">$</span><span class="st">`</span><span class="at">GDP per capita ($)</span><span class="st">`</span>, </span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels=</span>highlight_data<span class="sc">$</span>Country, <span class="at">pos=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend to explain the colors of the points</span></span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">names</span>(color_map), <span class="at">col =</span> color_map, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">title =</span> <span class="st">"Life Expectancy Category"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset graphical parameters to default</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>), <span class="at">bg=</span><span class="st">"white"</span>)  <span class="co"># Reset background color after plotting</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="histogram-displaying-carbon-footprints" class="level2">
<h2 class="anchored" data-anchor-id="histogram-displaying-carbon-footprints">Histogram: Displaying Carbon Footprints</h2>
<p>CO2 emissions refer to the release of carbon dioxide (CO2) into the atmosphere, mainly from burning fossil fuels like coal, oil, and gas. CO2 is a greenhouse gas, meaning it traps heat in the Earth’s atmosphere, contributing to global warming. Since CO2 emissions may not be intuitive to understand for the layman as the well-being or life expectancy features, I chose to inspect it as a uni variate. Histograms show the distributions and central tendency of one numerical variable.</p>
<p>Once more, I chose to make the background light grey instead of the defaulted white to be easier on the eye. With the same logic, I chose lighter shades of the primary colors blue and red. For the same reasons as the previous graph, we are working with Times New Roman throughout the graphic. I overlay a normal distribution curve to clearly indicate the shape of the distribution. Lastly, I change the defaulted y axis scale to be a count of observations in each bin for better interpretation of data.</p>
<p>The rightward skew of the distribution shows the tendency of most countries to fall in the range of 0 to 10 units of tCO2e. Fewer countries expend more than 20. Largest Emitters: China, the United States, and India are currently the largest CO2 emitters. However, per capita emissions are higher in developed countries like the U.S., Canada, and Australia.Over time, developed nations have contributed the most to historical emissions, making them key players in global climate efforts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming happyplanetdf is already loaded and "Carbon Footprint (tCO2e)" is numeric</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>carbon_footprint <span class="ot">&lt;-</span> happyplanetdf<span class="sc">$</span><span class="st">`</span><span class="at">Carbon Footprint (tCO2e)</span><span class="st">`</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove any NA values from the Carbon Footprint data</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>carbon_footprint <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(carbon_footprint)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set margins and create the histogram with counts</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"gray87"</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">4.1</span>, <span class="fl">3.1</span>, <span class="dv">0</span>), <span class="at">family =</span> <span class="st">"Times"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the histogram and store the result</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>hist_data <span class="ot">&lt;-</span> <span class="fu">hist</span>(</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  carbon_footprint,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="dv">20</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">freq =</span> <span class="cn">TRUE</span>,  <span class="co"># Set to TRUE to display counts</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Carbon Footprint (tCO2e)"</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Distribution of Carbon Footprint (tCO2e)"</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay a normal distribution curve adjusted for counts</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>x_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(carbon_footprint), <span class="fu">max</span>(carbon_footprint), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>dn <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x_seq, <span class="at">mean =</span> <span class="fu">mean</span>(carbon_footprint), <span class="at">sd =</span> <span class="fu">sd</span>(carbon_footprint))</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust the density values to match the count scale of the histogram</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(carbon_footprint)  <span class="co"># Total number of observations</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>bin_width <span class="ot">&lt;-</span> hist_data<span class="sc">$</span>breaks[<span class="dv">2</span>] <span class="sc">-</span> hist_data<span class="sc">$</span>breaks[<span class="dv">1</span>]  <span class="co"># Width of each bin</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>dn_counts <span class="ot">&lt;-</span> dn <span class="sc">*</span> n <span class="sc">*</span> bin_width  <span class="co"># Scale densities to counts</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay the adjusted normal curve</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x_seq, dn_counts, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"indianred3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset margins to default</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="barplots-of-continental-gdp-and-well-being" class="level2">
<h2 class="anchored" data-anchor-id="barplots-of-continental-gdp-and-well-being">Barplots of Continental GDP and Well-Being</h2>
<p>Barplots are often used to present summary statistics like means, medians, or totals. For instance, a barplot can show the average test scores for different schools, or the total sales for different products. They are useful for summarizing aggregated data where individual data points are grouped and the totals or averages are shown. Barplots make it easy to compare different categories or groups. Each bar represents a category, and the height (or length, in the case of horizontal barplots) shows the value of a specific variable for that category. With a glance, you can see which categories have higher or lower values, making it simple to identify trends or outliers. A barplot of GDP per capita by continent highlights economic differences across regions. For instance, wealthier regions like Western Europe and North America &amp; Oceania may have significantly higher GDP per capita compared to regions like Africa or South Asia. Higher GDP often correlates with advanced industrialization and better resource management, while lower GDP might reflect reliance on agriculture, limited industrial growth, or socio-political challenges.</p>
<p>I chose to list the GDP’s and Well-being scores by continent in descending order to enhance the message to the reader about where each one stands. This is the same reason I chose to incorporate gradients of blue and green, emphasizing the point that GDP’s influence might have on well-being. New labels were assigned to the bars as the data originally assigned numbers to each continent. To be legible, each word in the continent’s label had to be given its own line to prevent overlapping. For continuity from previous graphs, I added the “K” to represent units of GDP per capita in USD on the scale. I had to add much more space to the left side margins as they were blocking the y axis label from view and cluttering the data too much to the left side.</p>
<p>A barplot of well-being (which often measures life satisfaction, happiness, or general quality of life) shows how people feel about their lives on average. Even continents with lower GDP per capita may score higher on well-being, suggesting that wealth is not the sole determinant of happiness. High well-being scores in regions like Latin America or Western Europe might be linked to strong social safety nets, access to healthcare, education, and social cohesion, regardless of wealth levels. Well-being is often influenced by cultural values, family structures, work-life balance, and environmental quality, meaning that regions with modest GDP may still have high well-being due to factors such as strong community ties, lower stress, or natural beauty.</p>
<p>Barplots comparing GDP per capita and well-being across continents can show that economic wealth (higher GDP per capita) does not always translate into better well-being. For example, Western Europe might have both high GDP and well-being, while regions like Latin America may have moderate GDP but high well-being. Some regions with high GDP, such as North America, might show diminishing returns on well-being after a certain level of wealth, indicating that beyond basic needs, wealth alone may not significantly boost happiness. onversely, regions with lower GDP (e.g., Africa or South Asia) may also show lower well-being, pointing to the role of poverty in reducing overall life satisfaction due to factors like poor healthcare, education, and job security.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Barplot 1: Avg GDP per Continent</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom continent names with line breaks for each full word</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>continent_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Latin</span><span class="sc">\n</span><span class="st">America"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"N. America</span><span class="sc">\n</span><span class="st">&amp; Oceania"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Western</span><span class="sc">\n</span><span class="st">Europe"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Middle</span><span class="sc">\n</span><span class="st">East"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"5"</span> <span class="ot">=</span> <span class="st">"Africa"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"6"</span> <span class="ot">=</span> <span class="st">"South</span><span class="sc">\n</span><span class="st">Asia"</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"7"</span> <span class="ot">=</span> <span class="st">"Eastern Europe</span><span class="sc">\n</span><span class="st">&amp; Central Asia"</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"8"</span> <span class="ot">=</span> <span class="st">"East</span><span class="sc">\n</span><span class="st">Asia"</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the average GDP per capita by continent</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>avg_gdp_by_continent <span class="ot">&lt;-</span> happyplanetdf <span class="sc">%&gt;%</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Continent) <span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_gdp =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">GDP per capita ($)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_gdp))  <span class="co"># Optional: Sort by average GDP</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a color gradient from dark blue (for highest GDP) to light blue (for lowest GDP)</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>blue_gradient <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"darkblue"</span>, <span class="st">"lightblue"</span>))(<span class="fu">nrow</span>(avg_gdp_by_continent))</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Set graphical parameters (margins)</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"gray87"</span>)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="fl">2.1</span>), <span class="at">family =</span> <span class="st">"Times"</span>)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the barplot and suppress default y-axis labels (yaxt = "n")</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>midpts <span class="ot">&lt;-</span> <span class="fu">barplot</span>(avg_gdp_by_continent<span class="sc">$</span>avg_gdp, </span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col=</span>blue_gradient,  <span class="co"># Apply the blue gradient to the bars</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">names=</span><span class="fu">rep</span>(<span class="st">""</span>, <span class="fu">nrow</span>(avg_gdp_by_continent)),  <span class="co"># Suppress axis names initially</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(avg_gdp_by_continent<span class="sc">$</span>avg_gdp) <span class="sc">*</span> <span class="fl">1.2</span>),  <span class="co"># Extend y-axis a bit for labels</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main =</span> <span class="st">"Average GDP per Capita by Continent"</span>,</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab =</span> <span class="st">"Average GDP per Capita ($)"</span>,  <span class="co"># Add y-axis label here</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">yaxt =</span> <span class="st">"n"</span>)  <span class="co"># Suppress default y-axis</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Add custom y-axis with "K" notation for tick labels</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>y_ticks <span class="ot">&lt;-</span> <span class="fu">pretty</span>(avg_gdp_by_continent<span class="sc">$</span>avg_gdp)  <span class="co"># Generate "pretty" tick values</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>y_labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(y_ticks <span class="sc">/</span> <span class="dv">1000</span>, <span class="st">"K"</span>)  <span class="co"># Convert to 'K' format (e.g., 20K, 40K)</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> y_ticks, <span class="at">labels =</span> y_labels, <span class="at">col.axis =</span> <span class="st">"gray50"</span>, <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Add custom labels with line breaks for better readability</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(continent_labels[avg_gdp_by_continent<span class="sc">$</span>Continent], <span class="at">at=</span>midpts, <span class="at">side=</span><span class="dv">1</span>, <span class="at">line=</span><span class="fl">0.5</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Add text annotations on the bars (average GDP values)</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(midpts, avg_gdp_by_continent<span class="sc">$</span>avg_gdp, </span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">round</span>(avg_gdp_by_continent<span class="sc">$</span>avg_gdp, <span class="dv">0</span>),  <span class="co"># Display rounded GDP values</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">3</span>,  <span class="co"># Place the text above the bars</span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset graphical parameters to default after plotting</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Barplot 2: Avg Wellbeing Per Continent</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the average well-being by continent</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>avg_wellbeing_by_continent <span class="ot">&lt;-</span> happyplanetdf <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Continent) <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_wellbeing =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Ladder of life (Wellbeing) (0-10)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_wellbeing))  <span class="co"># Optional: Sort by average well-being</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a color gradient from dark green (for highest well-being) to light green (for lowest well-being)</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>green_gradient <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"lightgreen"</span>))(<span class="fu">nrow</span>(avg_wellbeing_by_continent))</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Set graphical parameters (margins) and background</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"gray87"</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="fl">2.1</span>), <span class="at">family =</span> <span class="st">"Times"</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the barplot and suppress default y-axis labels (yaxt = "n")</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>midpts <span class="ot">&lt;-</span> <span class="fu">barplot</span>(avg_wellbeing_by_continent<span class="sc">$</span>avg_wellbeing, </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col=</span>green_gradient,  <span class="co"># Apply the green gradient to the bars</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">names=</span><span class="fu">rep</span>(<span class="st">""</span>, <span class="fu">nrow</span>(avg_wellbeing_by_continent)),  <span class="co"># Suppress axis names initially</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(avg_wellbeing_by_continent<span class="sc">$</span>avg_wellbeing) <span class="sc">*</span> <span class="fl">1.2</span>),  <span class="co"># Extend y-axis a bit for labels</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main =</span> <span class="st">"Average Well-being by Continent"</span>,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab =</span> <span class="st">"Average Well-being (0-10)"</span>,  <span class="co"># Add y-axis label here</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">yaxt =</span> <span class="st">"n"</span>)  <span class="co"># Suppress default y-axis</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Add custom y-axis with tick labels for well-being scores</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>y_ticks <span class="ot">&lt;-</span> <span class="fu">pretty</span>(avg_wellbeing_by_continent<span class="sc">$</span>avg_wellbeing)  <span class="co"># Generate "pretty" tick values</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> y_ticks, <span class="at">labels =</span> y_ticks, <span class="at">col.axis =</span> <span class="st">"gray50"</span>, <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Add custom labels with line breaks for better readability</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(continent_labels[avg_wellbeing_by_continent<span class="sc">$</span>Continent], <span class="at">at=</span>midpts, <span class="at">side=</span><span class="dv">1</span>, <span class="at">line=</span><span class="fl">0.5</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Add text annotations on the bars (average well-being values)</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(midpts, avg_wellbeing_by_continent<span class="sc">$</span>avg_wellbeing, </span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">round</span>(avg_wellbeing_by_continent<span class="sc">$</span>avg_wellbeing, <span class="dv">1</span>),  <span class="co"># Display rounded well-being values</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">3</span>,  <span class="co"># Place the text above the bars</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab2_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset graphical parameters to default after plotting</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Together, these barplots can highlight whether wealthier regions are enjoying higher life satisfaction, or whether happiness can be achieved independently of wealth. They help in understanding global disparities in wealth and well-being, offering a broader perspective on human development and how various factors—beyond just economic growth—contribute to a region’s success and the quality of life of its inhabitants.</p>
</section>
<section id="boxplot" class="level2">
<h2 class="anchored" data-anchor-id="boxplot">Boxplot</h2>
<p>Boxplots (also known as box-and-whisker plots) are highly useful data visualization tools that summarize a dataset’s distribution in a concise and easy-to-interpret way. Five-Number Summary: Boxplots visually represent the five-number summary of a dataset:</p>
<p>Minimum: The smallest data point, excluding outliers.</p>
<p>First Quartile (Q1): The 25th percentile, where 25% of the data lies below this value.</p>
<p>Median (Q2): The middle value, where 50% of the data is below and 50% is above.</p>
<p>Third Quartile (Q3): The 75th percentile, where 75% of the data is below this value.</p>
<p>Maximum: The largest data point, excluding outliers.</p>
<p>This helps give a quick, visual summary of the central tendency and spread of the data.</p>
<p>Boxplots allow you to quickly see how the HPI varies across different continents. You can easily compare which regions have a higher or lower HPI, and whether their values are spread out or tightly clustered. The median line in each boxplot shows the central tendency of the HPI for each continent, while the size of the box (interquartile range) shows how much the HPI values vary within that region. he boxplot can easily identify outliers (represented by points outside the whiskers). For example, if a country in a continent has a significantly higher or lower HPI than others in that region, it will stand out. If one region shows more variability in its HPI scores than another, it could indicate that countries within that region have differing levels of success in achieving both happiness and sustainability.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set graphical parameters and margins</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"gray87"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">family =</span> <span class="st">"Times"</span>)  <span class="co"># Adjust margins</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a boxplot of HPI by Continent</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(HPI <span class="sc">~</span> Continent, <span class="at">data =</span> happyplanetdf,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">boxwex =</span> <span class="fl">0.25</span>,  <span class="co"># Box width</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"lightblue"</span>,  <span class="co"># Box color</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">""</span>,  <span class="co"># Empty x-axis label</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Happy Planet Index (HPI)"</span>,  <span class="co"># Y-axis label</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(happyplanetdf<span class="sc">$</span>HPI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">max</span>(happyplanetdf<span class="sc">$</span>HPI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="fl">1.2</span>),  <span class="co"># Adjust y-axis limits</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">xaxt =</span> <span class="st">"n"</span>)  <span class="co"># Suppress default x-axis labels</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add custom x-axis with continent names</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">labels =</span> continent_labels, <span class="at">las=</span><span class="dv">2</span>, <span class="at">cex.axis =</span> <span class="fl">0.8</span>)  <span class="co"># Rotating labels for readability</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a main title</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">"HPI by Continent"</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Add custom grid lines</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(happyplanetdf<span class="sc">$</span>HPI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">by=</span><span class="dv">10</span>), <span class="at">col=</span><span class="st">"gray90"</span>, <span class="at">lty=</span><span class="dv">3</span>)  <span class="co"># Horizontal grid lines</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a custom legend</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="st">"HPI Distribution"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset graphical parameters to default after plotting</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pie-charts-of-well-being-across-continents" class="level2">
<h2 class="anchored" data-anchor-id="pie-charts-of-well-being-across-continents">Pie Charts of Well-Being Across Continents</h2>
<p>Pie charts are a popular tool for visualizing data, particularly for displaying parts of a whole in a clear and easily understandable way. They are widely used in presentations and reports when the goal is to communicate simple proportions or percentages. Pie charts are most effective when showing how different categories contribute to a total. Each “slice” represents a proportion of the whole, making it easy to see which categories are dominant or which ones have a smaller share. Pie charts are useful for representing categorical data, such as market share, budget allocations, or survey results. Each slice represents a different category, and the size of the slice corresponds to its proportion within the dataset. Pie charts are particularly useful when there are one or two dominant categories that represent the bulk of the data. When there are too many categories, pie charts become cluttered and hard to interpret. Bar charts or other visualizations are more appropriate for larger data sets.</p>
<p>For each continent, a pie chart highlights the distribution of wellbeing among its population. This makes it easy to see how the different wellbeing categories (Poor, Average, Good) contribute to the overall picture for that continent. The barplot showed how continents rank in terms of average wellbeing. For example, one can quickly see which continent has the highest average wellbeing and which one has the lowest. The pie chart focuses on how the wellbeing scores are divided among categories, making it useful for qualitative insights (how the population is distributed across wellbeing categories).</p>
<p>In the barplots, we observed that continents with higher GDP per capita (such as North America &amp; Oceania and Western Europe) tend to have higher average wellbeing. The pie charts bear out a similar insight. Western Europe and North America &amp; Oceania display a large proportion of “Good” wellbeing in their pie charts. This indicates that a substantial portion of their populations enjoys a high quality of life, which aligns with the economic advantages reflected in the GDP barplot. The barplots showed that continents like Africa and South Asia, which have lower average GDP per capita, also have lower average wellbeing scores. The pie charts reinforce this insight. These regions face challenges related to poverty, inadequate infrastructure, and limited access to essential services, which translate into lower levels of overall wellbeing.</p>
<p>The middle-income continents, such as Latin America, Eastern Europe &amp; Central Asia, and parts of East Asia, are more mixed in their wellbeing outcomes, both in the barplots and in the pie charts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentages of Wellbeing categories for each continent</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Color map for the Wellbeing categories, including NA for missing data</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>color_map <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Poor"</span> <span class="ot">=</span> <span class="st">"indianred3"</span>, <span class="st">"Average"</span> <span class="ot">=</span> <span class="st">"yellow2"</span>, <span class="st">"Good"</span> <span class="ot">=</span> <span class="st">"limegreen"</span>, <span class="st">"NA"</span> <span class="ot">=</span> <span class="st">"gray70"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentages of Wellbeing categories for each continent</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>wellbeing_pct <span class="ot">&lt;-</span> happyplanetdf <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Continent, Wellbeing_Category) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>(Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))  <span class="co"># Calculate percentages for each category</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Continent'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom continent names with line breaks for each full word</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>continent_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Latin America"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"N. America &amp;</span><span class="sc">\n</span><span class="st">Oceania"</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Western Europe"</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Middle East"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5"</span> <span class="ot">=</span> <span class="st">"Africa"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"6"</span> <span class="ot">=</span> <span class="st">"South Asia"</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"7"</span> <span class="ot">=</span> <span class="st">"Eastern Europe &amp; Central Asia"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"8"</span> <span class="ot">=</span> <span class="st">"East Asia"</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up graphical parameters for multiple plots in one pane</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>),  <span class="co"># 2 rows, 4 columns layout for 8 continents</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="sc">+</span> <span class="fl">0.1</span>,  <span class="co"># Adjust margins for larger pie charts</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg =</span> <span class="st">"gray87"</span>,  <span class="co"># Set the background to grey</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"Times"</span>)  <span class="co"># Set the font to Times New Roman</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each continent and create a pie chart for each</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (continent <span class="cf">in</span> <span class="fu">unique</span>(happyplanetdf<span class="sc">$</span>Continent)) {</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Subset the data for the current continent</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    continent_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(wellbeing_pct, Continent <span class="sc">==</span> continent)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pie chart data</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    pie_values <span class="ot">&lt;-</span> continent_data<span class="sc">$</span>Percentage</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    pie_labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(continent_data<span class="sc">$</span>Percentage, <span class="st">"%"</span>)  <span class="co"># Add percentage labels</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    pie_colors <span class="ot">&lt;-</span> color_map[continent_data<span class="sc">$</span>Wellbeing_Category]</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the pie chart</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pie</span>(pie_values, </span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> pie_labels, </span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> pie_colors, </span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> continent_labels[<span class="fu">as.character</span>(continent)],  <span class="co"># Use custom continent labels</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex =</span> <span class="fl">1.2</span>,  <span class="co"># Increase text size for percentages</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">radius =</span> <span class="fl">1.1</span>)  <span class="co"># Adjust pie size to fit within the space</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Stay in the same plotting area and manually adjust the position of the legend</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a custom legend for Wellbeing categories, including NA</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottom"</span>, </span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Poor"</span>, <span class="st">"Average"</span>, <span class="st">"Good"</span>, <span class="st">"Missing (NA)"</span>), </span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"indianred3"</span>, <span class="st">"yellow2"</span>, <span class="st">"limegreen"</span>, <span class="st">"gray70"</span>), </span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"n"</span>,  <span class="co"># No border around the legend</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">1.0</span>,  <span class="co"># Adjust text size slightly smaller</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">x.intersp =</span> <span class="fl">0.1</span>,  <span class="co"># Adjust spacing between boxes and text</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">inset =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.6</span>),  <span class="co"># Move the legend down but keep within the plot area</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">horiz =</span> F,  <span class="co"># Arrange the legend horizontally</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">xpd =</span> <span class="cn">TRUE</span>)  <span class="co"># Allow drawing outside the plot area</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset graphical parameters to default after plotting</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># Reset to single plot mode</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="the-end" class="level1">
<h1>The End</h1>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>